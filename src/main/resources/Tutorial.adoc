= Gradle - Scala Skeleton Project
Jnorthr <james.northrop@orange.fr>
v0.5, 2015-08-02
:icons: font
:toc: left
:imagesdir: images
:sectlinks:
:sectnums:

== Purpose

The GitHub repo *gradle-scala* is a full skeleton project to build scala stuff using gradle. Clone includes gradle build tool wrapper and folder structure like maven/gradle. It's a shell project, it already includes the *gradle* build toolkit, so you just add your own scala source files in the /scala folder. Should be simple if you have 10 min.s:
 
== Get It

 * clone repo into empty folder

[source,bash]
----
RedApple:jim /Users/jim/Downloads $ git clone https://github.com/jnorthr/gradle-scala.git
Cloning into 'gradle-scala'...
remote: Counting objects: 118, done.
remote: Compressing objects: 100% (65/65), done.
remote: Total 118 (delta 38), reused 114 (delta 38), pack-reused 0
Receiving objects: 100% (118/118), 351.32 KiB | 176.00 KiB/s, done.
Resolving deltas: 100% (38/38), done.
Checking connectivity... done.
----

== Get Ready

 * cd into that folder

[source,bash]
----
RedApple:jim /Users/jim/Downloads $ cd gradle-scala/
----

 * the gradle wrapper is already included so u do *NOT* need to install gradle build tool

 * open console terminal

== Confirm Pieces Are In place

 * from command line do this *check* to confirm everything is ok; gradle will download some dependency jars from mavenCentral then check all pieces are ok - yes you do need an internet connect at this point . . .

[source,bash]
----
RedApple:jim /Users/jim/Downloads/gradle-scala $ gradlew check
-bash: gradlew: command not found

RedApple:jim /Users/jim/Downloads/gradle-scala $ ./gradlew check
Starting a new Gradle Daemon for this build (subsequent builds will be faster).
Parallel execution is an incubating feature.
:compileJava UP-TO-DATE
:compileScala
:processResources UP-TO-DATE
:classes
:compileTestJava UP-TO-DATE
:compileTestScala UP-TO-DATE
:processTestResources UP-TO-DATE
:testClasses UP-TO-DATE
:test UP-TO-DATE
:check UP-TO-DATE

BUILD SUCCESSFUL

Total time: 15.238 secs
----

== What Else Can Gradle Do ?

 * `./gradlew tasks`

This command will show you all possible task names you can run after the *./gradlew* command for ex. `./gradlew check`

== Time To Build Our Project

 *  `./gradlew build`  

This command compiles scala code in the /scala folder and/or java source code in the /java folder

[source,bash]
----
RedApple:jim /Users/jim/Downloads/gradle-scala $ ./gradlew build
Parallel execution is an incubating feature.
:compileJava UP-TO-DATE
:compileScala UP-TO-DATE
:processResources UP-TO-DATE
:classes UP-TO-DATE
:jar
:assemble
:compileTestJava UP-TO-DATE
:compileTestScala UP-TO-DATE
:processTestResources UP-TO-DATE
:testClasses UP-TO-DATE
:test UP-TO-DATE
:check UP-TO-DATE
:build

BUILD SUCCESSFUL

Total time: 3.599 secs
----

== Run The App

 * `./gradlew run`

This command executes *HelloWorld.scala* code and rebuilds everything if anything changed since last build.

[source,bash]
----
RedApple:jim /Users/jim/Downloads/gradle-scala $ ./gradlew run
Parallel execution is an incubating feature.
:compileJava UP-TO-DATE
:compileScala UP-TO-DATE
:processResources UP-TO-DATE
:classes UP-TO-DATE
:runSimple
Hello, world!

BUILD SUCCESSFUL

Total time: 4.714 secs
----

== Write Some Documentation Automagically

 * `./gradlew scaladoc`  

Yes, we can generate and write javadocs, test results and several reports like this 

[source,bash]
----
RedApple:jim /Users/jim/Downloads/scala $ ./gradlew scaladoc
Parallel execution is an incubating feature.
:compileJava UP-TO-DATE
:compileScala UP-TO-DATE
:processResources UP-TO-DATE
:classes UP-TO-DATE
:scaladoc
[ant:scaladoc] Element '/Users/jim/Downloads/scala/build/resources/main' does not exist.


BUILD SUCCESSFUL

Total time: 13.82 secs
----

'''

TIP: Look into `/build/docs/scaladoc/index.html` for your api documentation

image::Screenshot%202015-08-03%2023.25.59.png[Project Folder After Build,float="right"]

== Project Folder Layout

After the *build* task completes, another folder named *build/* is written within the *gradle-scala* project folder. It has these features :

 * The *Build* folder holds all components produced during the *build* task
 * Notice the *HelloWorld.class* is nested within a typical folder structure for a package 
 * *Docs* folder has html for the `scaladocs` task documentation / API
 * *Libs* folder has the resulting *.jar* of the project including necessary dependent jars
 * Several files support the gradle tool plus a `gradle` folder holding gradle wrapper pieces and a `.gradle` folder of working values
 * A `License` file, `README.md` file and `Tutorial.adoc` file provide supporting documentation 

== Build.gradle 

Here are instructions for the gradle build tool. // precede comments
[source,gradle,linenums]
----
// gradle-scala build.gradle file to test ideas
// http://mrhaki.blogspot.fr/2009/11/using-gradle-for-mixed-java-and-groovy.html

// get externals via plugins
apply plugin:'java'
apply plugin:'scala'
 
// project version - replacement syntax is of the form ${. . .}
version = "1.0-${new Date().format('yyyyMMdd')}"

// If no tasks on gradlew command line then do these:
defaultTasks 'runSimple'

// identify remote repository to get missing jars from
repositories{
	mavenCentral()
}

// Gradle will download these jars if needed;  junit not reallt needed here as no tests were provided.
dependencies{
	compile 'org.scala-lang:scala-library:2.11.2'
	compile 'org.scala-lang:scala-compiler:2.11.2' 
	testCompile 'junit:junit:4.12'
}

buildscript {
  repositories { mavenCentral() }
}

// setup a task to run the main module of the project 
task(runSimple, dependsOn: 'classes', type: JavaExec) {
	main = 'com.jim.HelloWorld'
	classpath = sourceSets.main.runtimeClasspath
	args 'jimbo', 'hi kids'
	systemProperty 'simple.message', 'Hi kids '
}

// run this task once to build project folder structure like
// bash ./gradlew crtProject 
task "crtProject" << {
   sourceSets*.java.srcDirs*.each { it.mkdirs() }
   sourceSets*.scala.srcDirs*.each { it.mkdirs() }
   sourceSets*.resources.srcDirs*.each { it.mkdirs() }
}

task wrapper(type: Wrapper) {
    gradleVersion '2.5'
}
----

== Travis Continuous Integration Service

When trying to connect *Travis continuous integration service*, i had a *.travis.yml* manifest that declared `groovy` was the language of choice and since a *build.gradle* file was present, the travis documents said travis would build my gradle-scala project using gradle. But this did not happen. 
Could not figure out why not, until i read this:

http://docs.travis-ci.com/user/getting-started/[Travis C/I Getting Started]

 *  *Add the .travis.yml file to git, commit and push, to trigger a Travis CI build:*

WARNING: Travis only runs a build on the commits you push *after* adding the repository to Travis. *Note:* even if your project already has a *.travis.yml* file, you need to git push another commit to trigger a build.

''''

enjoy ;-)
